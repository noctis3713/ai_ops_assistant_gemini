# ============================================================================
# AI 網路維運助理 - 環境變數配置檔案
# ============================================================================
# 版本：v2.1.0
# 最後更新：2025-08-02
# 
# 注意事項：
# 1. 生產環境請務必修改預設密碼和 API 金鑰
# 2. 數值型環境變數支援動態調整（部分需重啟服務）
# 3. 布林值請使用 true/false（小寫）
# 4. 修改後建議測試相關功能是否正常運作
# ============================================================================

# ============================================================================
# AI 服務核心配置
# ============================================================================

# AI 提供者 API 金鑰
# 重要：生產環境請使用自己的 API 金鑰
GOOGLE_API_KEY=AIzaSyBpuxp245NWUZcAD9eetqhGSQ8teExyeQ8
ANTHROPIC_API_KEY=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

# AI 提供者選擇
# 可選值：gemini, claude
# 影響：決定使用哪個 AI 引擎進行分析
# 建議：claude（更準確但成本較高）, gemini（更快速且成本較低）
AI_PROVIDER=claude

# 文檔搜尋功能（實驗性功能）
# 可選值：true, false
# 影響：啟用後可搜尋 Cisco 指令文檔
# 建議：保持 false（功能尚未完全整合）
ENABLE_DOCUMENT_SEARCH=false

# ============================================================================
# AI 模型詳細配置
# ============================================================================

# Google Gemini 模型選擇
# 可選值：
#   - gemini-1.5-flash-latest (⭐推薦：速度快、成本低、適合即時查詢)
#   - gemini-1.5-pro-latest (效能更好、成本較高、適合複雜分析)
#   - gemini-1.0-pro (舊版本，不推薦)
# 成本比較：flash < pro (約 10-20 倍差異)
# 回應時間：flash (1-2秒) < pro (3-5秒)
GEMINI_MODEL=gemini-1.5-flash-latest

# Anthropic Claude 模型選擇
# 可選值：
#   - claude-3-haiku-20240307 (⭐推薦：速度快、成本低)
#   - claude-3-sonnet-20240229 (平衡效能與成本)
#   - claude-3-opus-20240229 (最高效能、最高成本)
#   - claude-3-5-sonnet-20241022 (最新版本、效能極佳)
# 成本比較：haiku < sonnet < opus (約 5-15 倍差異)
# 回應時間：haiku (1-2秒) < sonnet (2-4秒) < opus (4-8秒)
CLAUDE_MODEL=claude-3-haiku-20240307

# ============================================================================
# 網路設備認證配置
# ============================================================================

# 設備登入憑證
# 注意：這些是所有設備的預設認證資訊
# 個別設備可在 config/devices.json 中覆蓋
DEVICE_USERNAME=admin
DEVICE_PASSWORD=mbfg2017

# 設備類型
# 可選值：cisco_xe, cisco_ios, juniper, arista
# 影響：決定使用的 Netmiko 設備驅動
# 建議：cisco_xe（適用於現代 Cisco 設備）
DEVICE_TYPE=cisco_xe

# ============================================================================
# 網路連線和效能配置
# ============================================================================

# SSH 連線池設定
# 最大並發連線數量
# 範圍：1-20，建議：3-10
# 影響：同時連接的設備數量，過高可能造成網路擁塞
# 注意：受限於設備的最大 SSH 連線數
MAX_CONNECTIONS=5

# 連線超時設定（秒）
# 範圍：30-600，建議：180-300
# 影響：等待設備回應的最長時間
# 注意：網路延遲高的環境建議增加此值
CONNECTION_TIMEOUT=300

# 設備健康檢查間隔（秒）
# 範圍：10-300，建議：30-60
# 影響：定期檢查設備連線狀態的頻率
# 注意：間隔太短可能增加網路負載
HEALTH_CHECK_INTERVAL=30

# 指令執行超時（秒）
# 範圍：5-120，建議：10-30
# 影響：單一指令等待回應的時間
# 注意：複雜指令（如路由表）可能需要更長時間
COMMAND_TIMEOUT=20

# ============================================================================
# 快取系統配置
# ============================================================================

# 快取最大條目數
# 範圍：100-2000，建議：256-1024
# 影響：記憶體使用量和快取命中率
# 計算：每條目約 1-10KB，512 條目約 5MB 記憶體
CACHE_MAX_SIZE=512

# 快取存活時間（秒）
# 範圍：60-1800，建議：300-600
# 影響：快取資料的新鮮度
# 注意：設備配置變更頻繁時建議縮短 TTL
CACHE_TTL=300

# ============================================================================
# Nornir 並發處理配置
# ============================================================================

# Nornir 工作者數量
# 範圍：1-20，建議：3-10
# 影響：批次操作的並發程度
# 注意：需要與 MAX_CONNECTIONS 配合調整
NORNIR_WORKERS=5

# ============================================================================
# AI 摘要和輸出處理配置
# ============================================================================

# AI 摘要功能開關
# 可選值：true, false
# 影響：長輸出是否使用 AI 進行摘要
# 建議：false（避免額外的 AI API 消耗）
# 注意：僅在 AI 查詢模式下有效，設備指令模式不受影響
ENABLE_AI_SUMMARIZATION=false

# AI 摘要觸發門檻（字元數）
# 範圍：5000-50000，建議：8000-15000
# 影響：超過此字元數才觸發 AI 摘要
# 成本：每次摘要約消耗 500-2000 tokens
AI_SUMMARY_THRESHOLD=10000

# 設備指令輸出最大長度（字元數）
# 範圍：10000-100000，建議：30000-60000
# 影響：防止超大輸出影響系統效能
# 注意：truncated 的輸出會有明確標示
DEVICE_OUTPUT_MAX_LENGTH=50000

# 輸出處理最大長度（字元數）
# 範圍：10000-100000，建議：30000-60000
# 影響：network_tools.py 中的輸出處理上限
# 注意：與 DEVICE_OUTPUT_MAX_LENGTH 保持一致
OUTPUT_MAX_SIZE=50000

# ============================================================================
# AI 解析器配置
# ============================================================================

# AI 輸出解析器版本
# 可選值：
#   - original: 原版解析器 (99行，最健壯，相容性最佳)
#   - simplified: 簡化版解析器 (35行，最簡潔，效能最佳)
#   - balanced: 平衡版解析器 (55行，⭐推薦，平衡效能與健壯性)
# 影響：AI 回應解析的準確性和效能
# 建議：balanced（在功能和效能間取得最佳平衡）
PARSER_VERSION=balanced

# ============================================================================
# 日誌系統配置
# ============================================================================

# 後端日誌配置
# 日誌檔案最大大小（位元組）
# 預設：10485760 = 10MB
# 範圍：1MB-100MB，建議：5MB-20MB
# 影響：單一日誌檔案大小，超過後自動輪轉
LOG_MAX_SIZE=10485760

# 保留備份檔案數量
# 範圍：1-20，建議：3-10
# 影響：磁碟空間使用量 = LOG_MAX_SIZE × LOG_BACKUP_COUNT × 4（四種日誌類型）
# 計算：目前設定約佔用 200MB 磁碟空間
LOG_BACKUP_COUNT=5

# 後端日誌記錄級別
# 可選值：DEBUG, INFO, WARNING, ERROR
# 影響：
#   - DEBUG: 最詳細，包含所有除錯資訊（開發環境）
#   - INFO: 一般資訊，適合生產環境監控
#   - WARNING: 僅警告和錯誤（精簡模式）
#   - ERROR: 僅錯誤（最精簡）
LOG_LEVEL=INFO

# 前端日誌處理配置
# 是否在後端控制台顯示前端日誌
# 可選值：true, false
# 影響：前端日誌是否同時輸出到後端控制台
# 建議：簡化日誌系統，統一使用檔案記錄
BACKEND_ENABLE_FRONTEND_CONSOLE_LOG=false

# ============================================================================
# 非同步任務管理配置
# ============================================================================

# 任務存活時間（秒）
# 預設：86400 = 24小時
# 範圍：3600-604800（1小時-7天），建議：43200-86400（12-24小時）
# 影響：任務記錄保留時間，過期後自動清理
# 注意：過短可能影響任務結果查詢，過長會增加記憶體使用
ASYNC_TASK_TTL=86400

# 任務清理檢查間隔（秒）
# 預設：3600 = 1小時
# 範圍：300-7200（5分鐘-2小時），建議：1800-7200（30分鐘-2小時）
# 影響：過期任務清理的頻率
# 注意：間隔太短會增加系統負載，太長會延遲記憶體釋放
ASYNC_TASK_CLEANUP_INTERVAL=3600

# ============================================================================
# 安全和管理配置
# ============================================================================

# 管理 API 認證金鑰
# 用途：配置重載等管理操作的認證
# 重要：生產環境請務必修改為強密碼
# 建議：使用至少16位包含大小寫字母、數字、特殊字元的複雜密碼
# 範例：openssl rand -base64 32
ADMIN_API_KEY=admin123

# ============================================================================
# 前端日誌後端處理配置
# ============================================================================
# 注意：前端UI配置已移至 frontend/config/.env.local 管理
# 此處僅為後端處理前端日誌的相關配置

# 前端錯誤堆棧追蹤
# 可選值：true, false
# 影響：是否包含 JavaScript 錯誤的堆棧追蹤
# 建議：開發環境 true，生產環境 false（隱私考量）
# 用途：後端控制前端是否顯示敏感的錯誤堆疊資訊
FRONTEND_LOG_ENABLE_STACK_TRACE=true


# ============================================================================
# 環境變數配置說明
# ============================================================================
# 
# 📊 環境變數統計：後端核心配置 35 個
# 📂 前端UI配置：請參考 frontend/config/.env.local
# 
# 📊 不同環境建議值：
# 
# 🔧 開發環境：
#   - LOG_LEVEL=DEBUG
#   - BACKEND_ENABLE_FRONTEND_CONSOLE_LOG=false
#   - FRONTEND_LOG_ENABLE_STACK_TRACE=true
#   - CACHE_TTL=60 (快速測試)
# 
# 🚀 測試環境：
#   - LOG_LEVEL=INFO
#   - ASYNC_TASK_TTL=43200 (12小時)
#   - CACHE_TTL=300
# 
# 🏭 生產環境：
#   - LOG_LEVEL=INFO 或 WARNING
#   - ADMIN_API_KEY=<強密碼>
#   - BACKEND_ENABLE_FRONTEND_CONSOLE_LOG=false
#   - FRONTEND_LOG_ENABLE_STACK_TRACE=false
#   - LOG_BACKUP_COUNT=10 (保留更多日誌)
# 
# 💡 效能調校建議：
#   - 高負載環境：增加 MAX_CONNECTIONS 和 NORNIR_WORKERS
#   - 網路延遲高：增加 CONNECTION_TIMEOUT 和 COMMAND_TIMEOUT
#   - 記憶體有限：減少 CACHE_MAX_SIZE 和 ASYNC_TASK_TTL
#   - 磁碟空間有限：減少 LOG_MAX_SIZE 和 LOG_BACKUP_COUNT
# 
# ============================================================================